

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Python API &mdash; Swissroads 1.0.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Troubleshooting" href="troubleshooting.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Swissroads
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="userguide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Python API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Swissroads</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Python API</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-analysis">
<span id="python-api"></span><h1>Python API<a class="headerlink" href="#module-analysis" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="analysis.create_data_sets">
<code class="sig-prename descclassname">analysis.</code><code class="sig-name descname">create_data_sets</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analysis.html#create_data_sets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analysis.create_data_sets" title="Permalink to this definition">¶</a></dt>
<dd><p>The create_data_sets function splits the whole swissroads dataset into 3 main parts:
train, test and valid.
The train part is used to train the model.
The test part is used to test the model during the training phase.
The valid part is used to validate finally our model.</p>
<p>This function aims at plotting exemples images of each category.
The function takes 2 parameters as input and return True is all runs ok:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df_test</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.2.0.dev0+653.g1f6710035)"><em>pandas.DataFrame</em></a>) – The pandas DataFrame containing the data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The numpy arrays corrisponds to X_tr, y_tr, X_te, y_te, X_va, y_va.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="analysis.get_batches">
<code class="sig-prename descclassname">analysis.</code><code class="sig-name descname">get_batches</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">batch_size</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analysis.html#get_batches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analysis.get_batches" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a list into batches of a given size and yield them one by one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – </p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – must be the same length of X.</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The size of each generated batches</p></li>
<li><p><strong>Returns</strong> – </p></li>
<li><p><strong>----------</strong> – </p></li>
<li><p><strong>batch</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a><em>, </em><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – a Y,y batch of size batch_size, the last batch yielded may not be of this size depending on the length of the X input</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="analysis.create_execute_TF_graph">
<code class="sig-prename descclassname">analysis.</code><code class="sig-name descname">create_execute_TF_graph</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">epochs</span></em>, <em class="sig-param"><span class="n">X_tr</span></em>, <em class="sig-param"><span class="n">X_te</span></em>, <em class="sig-param"><span class="n">X_va</span></em>, <em class="sig-param"><span class="n">y_tr</span></em>, <em class="sig-param"><span class="n">y_te</span></em>, <em class="sig-param"><span class="n">y_va</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analysis.html#create_execute_TF_graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analysis.create_execute_TF_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>The function create_execute_TF_graph is the function in charge of creating a tensorflow graph
to be then called by the function analysis.main() and be trained.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of epochs to be then applied by tensorflow to train the model.</p></li>
<li><p><strong>X_tr</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – Numpy array containing the features to train the model.</p></li>
<li><p><strong>X_te</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – Numpy array containing the features to test the model.</p></li>
<li><p><strong>X_va</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – Numpy array containing the features to validate the model.</p></li>
<li><p><strong>y_tr</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – Numpy array containing the output vector to train the model.</p></li>
<li><p><strong>y_te</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – Numpy array containing the output vector to test the model.</p></li>
<li><p><strong>y_va</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – Numpy array containing the output vector to validate the model.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>train_acc: float</dt><dd><p>Float containing the train accuracy.</p>
</dd>
<dt>test_acc: float</dt><dd><p>Float containing the test accuracy.</p>
</dd>
<dt>y_te_predict: numpy.ndarray</dt><dd><p>Numpy array containing the output vector of the predictions from the test features.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="analysis.get_confusion_matrix">
<code class="sig-prename descclassname">analysis.</code><code class="sig-name descname">get_confusion_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">y_te</span></em>, <em class="sig-param"><span class="n">y_values</span></em>, <em class="sig-param"><span class="n">vals</span></em>, <em class="sig-param"><span class="n">labels</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analysis.html#get_confusion_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analysis.get_confusion_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Function returning the confusion matrix based on input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_te</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – numpy array containing the model values.</p></li>
<li><p><strong>y_values</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – numpy array containing the real values.</p></li>
<li><p><strong>vals</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of labels to create the confusion matrix.</p></li>
<li><p><strong>labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of labels to be used in the output DataFrame.</p></li>
<li><p><strong>Returns</strong> – </p></li>
<li><p><strong>----------</strong> – </p></li>
<li><p><strong>df_res</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.2.0.dev0+653.g1f6710035)"><em>pandas.DataFrame</em></a>) – Pandas DataFrame containing the confusion matrix to be displayed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="analysis.main">
<code class="sig-prename descclassname">analysis.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">epochs</span><span class="o">=</span><span class="default_value">15</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/analysis.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#analysis.main" title="Permalink to this definition">¶</a></dt>
<dd><p>The main() function is the main function to execute the Neural network modelling phase
from the swissroads dataset.
It reads all the image files from the folder named “swissroads_images” and trains a 2 layer NN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.2.0.dev0+653.g1f6710035)"><em>pandas.DataFrame</em></a>) – Pandas DataFrame containing the input Data.</p></li>
<li><p><strong>epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – number of epoches for the Nueral Network training phase.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pandas DataFrame containing the images data and downloaded features from Tensorflow hub.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.2.0.dev0+653.g1f6710035)">pandas.DataFrame</a></p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-baseline"></span><dl class="py function">
<dt id="baseline.cat2num">
<code class="sig-prename descclassname">baseline.</code><code class="sig-name descname">cat2num</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baseline.html#cat2num"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#baseline.cat2num" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the int value of a given category</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>string</em>) – value can either be: ‘bike’ ‘car’ ‘motorcycle’ ‘other’ ‘truck’ ‘van’</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>value from 0 to 5 included corresponding to the int equivalent of the category input</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="baseline.main">
<code class="sig-prename descclassname">baseline.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/baseline.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#baseline.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the logistic regression baseline.</p>
<p>The function will provide system output for its statistics, including a confusion matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.2.0.dev0+653.g1f6710035)"><em>pandas.DataFrame</em></a>) – The dataframe generated by data_exploration.main()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>baseline_acc_tr</strong> (<em>float</em>) – The accuracy of the training set</p></li>
<li><p><strong>baseline_acc_te</strong> (<em>float</em>) – The accuracy of the test set</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-data_exploration"></span><dl class="py function">
<dt id="data_exploration.plot_images">
<code class="sig-prename descclassname">data_exploration.</code><code class="sig-name descname">plot_images</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df_test</span></em>, <em class="sig-param"><span class="n">categories</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_exploration.html#plot_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data_exploration.plot_images" title="Permalink to this definition">¶</a></dt>
<dd><p>The plot_images function allow to explore the data through plots.</p>
<p>This function aims at plotting exemples images of each category.
The function takes 2 parameters as input and return True is all runs ok:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_test</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.2.0.dev0+653.g1f6710035)"><em>pandas.DataFrame</em></a>) – The pandas DataFrame containing the data.</p></li>
<li><p><strong>categories</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – This second parameter is a python list containing the data categories.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if successful, False otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="data_exploration.apply_PCA">
<code class="sig-prename descclassname">data_exploration.</code><code class="sig-name descname">apply_PCA</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">df</span></em>, <em class="sig-param"><span class="n">categories</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_exploration.html#apply_PCA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data_exploration.apply_PCA" title="Permalink to this definition">¶</a></dt>
<dd><p>The apply_PCA function allow to explore the data through plots.</p>
<p>This function aims at plotting exemples images of each category.
The function takes 2 parameters as input and return True is all runs ok:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_test</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.2.0.dev0+653.g1f6710035)"><em>pandas.DataFrame</em></a>) – The pandas DataFrame containing the data.</p></li>
<li><p><strong>categories</strong> (<em>Python list</em>) – This second parameter is a python list containing the data categories.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if successful, False otherwise.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="data_exploration.main">
<code class="sig-prename descclassname">data_exploration.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_exploration.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#data_exploration.main" title="Permalink to this definition">¶</a></dt>
<dd><p>The main() function is the main function to be launched to get the dataset
stored into a pandas DataFrame.
It reads all the image files from the folder named “swissroads_images”.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Pandas DataFrame containing the images data and downloaded features from Tensorflow hub.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/dev/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.2.0.dev0+653.g1f6710035)">pandas.DataFrame</a></p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-database"></span><dl class="py function">
<dt id="database.get_images">
<code class="sig-prename descclassname">database.</code><code class="sig-name descname">get_images</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">folder_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/database.html#get_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#database.get_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively read all folder content, open all images with PIL and create array containing images data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder_name</strong> (<em>string</em>) – name of the folder containing the images</p></li>
<li><p><strong>Returns</strong> – </p></li>
<li><p><strong>----------</strong> – </p></li>
<li><p><strong>batches_data</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – Nx(224x224) array containing resized images in a normalized float32 format</p></li>
<li><p><strong>batches_cat</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – Nx1 array containing the category of each sample as string</p></li>
<li><p><strong>batches_file</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – Nx1 array containing the file path of the image sample</p></li>
<li><p><strong>batches_folder</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><em>numpy.ndarray</em></a>) – Nx1 array containing the folder type, can either be ‘test’, ‘train’ or ‘valid’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="database.get_batches">
<code class="sig-prename descclassname">database.</code><code class="sig-name descname">get_batches</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">batch_size</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/database.html#get_batches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#database.get_batches" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a list into batches of a given size and yield them one by one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of any kind to be split</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The size of each generated batches</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>batch</strong> – a batch of size batch_size, the last batch yielded may not be of this size depending on the lenght of the X input</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="database.load_data">
<code class="sig-prename descclassname">database.</code><code class="sig-name descname">load_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">folder_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/database.html#load_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#database.load_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the images present in a given folder, create a database from it and save it in a .npz file.</p>
<p>A ‘output’ folder must exist for the database to be saved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>folder_name</strong> (<em>string</em>) – name of the folder containing the images</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="troubleshooting.html" class="btn btn-neutral float-left" title="Troubleshooting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Idiap Research Institute

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>